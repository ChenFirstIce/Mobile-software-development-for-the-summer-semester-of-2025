<!--pages/album/album.wxml-->
<view class="container">
  <!-- é¡¶éƒ¨æ“ä½œæ  -->
  <view class="top-bar">
    <view class="search-box">
      <input style="height: 74rpx; display: block; box-sizing: border-box" class="search-input" placeholder="æœç´¢ç›¸å†Œ..." bindinput="onSearchInput" value="{{searchKeyword}}" />
      <view class="search-icon">ğŸ”</view>
    </view>
    <button class="btn-primary" bindtap="createAlbum">åˆ›å»ºç›¸å†Œ</button>
  </view>

  <!-- ç›¸å†Œç±»å‹åˆ‡æ¢ -->
  <view class="type-tabs">
    <view class="tab-item {{currentType === 'all' ? 'active' : ''}}" bindtap="switchType" data-type="all">
      <text class="tab-text">å…¨éƒ¨</text>
    </view>
    <view class="tab-item {{currentType === 'personal' ? 'active' : ''}}" bindtap="switchType" data-type="personal">
      <text class="tab-text">ä¸ªäºº</text>
    </view>
    <view class="tab-item {{currentType === 'shared' ? 'active' : ''}}" bindtap="switchType" data-type="shared">
      <text class="tab-text">å…±æœ‰</text>
    </view>
  </view>

  <!-- ç›¸å†Œåˆ—è¡¨ -->
  <view class="album-list" wx:if="{{filteredAlbums.length > 0}}">
    <view class="album-item" wx:for="{{filteredAlbums}}" wx:key="id" bindtap="openAlbum" data-id="{{item.id}}">
      <view class="album-cover">
        <image wx:if="{{item.coverImage}}" src="{{item.coverImage}}" mode="aspectFill" class="cover-image"></image>
        <view wx:else class="cover-placeholder">
          <text class="placeholder-icon">ğŸ“·</text>
        </view>
        <view class="album-type-badge {{item.type === 'shared' ? 'shared' : 'personal'}}">
          {{item.type === 'shared' ? 'å…±æœ‰' : 'ä¸ªäºº'}}
        </view>
      </view>
      
      <view class="album-info">
        <view class="album-header">
          <text class="album-name">{{item.name}}</text>
          <view class="album-actions">
            <view class="action-btn" catchtap="editAlbum" data-id="{{item.id}}">
              <text class="action-icon">âœï¸</text>
            </view>
            <view class="action-btn" catchtap="deleteAlbum" data-id="{{item.id}}">
              <text class="action-icon">ğŸ—‘ï¸</text>
            </view>
          </view>
        </view>
        
        <text class="album-desc">{{item.description || 'æš‚æ— æè¿°'}}</text>
        
        <view class="album-stats">
          <view class="stat-item">
            <text class="stat-icon">ğŸ“¸</text>
            <text class="stat-text">{{item.photoCount || 0}}å¼ ç…§ç‰‡</text>
          </view>
          <view class="stat-item">
            <text class="stat-icon">ğŸ‘¥</text>
            <text class="stat-text">{{item.memberCount || 1}}äºº</text>
          </view>
          <view class="stat-item">
            <text class="stat-icon">ğŸ“…</text>
            <text class="stat-text">{{item.createTime}}</text>
          </view>
        </view>
      </view>
    </view>
  </view>

  <!-- ç©ºçŠ¶æ€ -->
  <view class="empty-state" wx:else>
    <view class="empty-icon">ğŸ“·</view>
    <text class="empty-title">æš‚æ— ç›¸å†Œ</text>
    <text class="empty-desc">åˆ›å»ºæ‚¨çš„ç¬¬ä¸€ä¸ªç›¸å†Œï¼Œå¼€å§‹è®°å½•ç¾å¥½æ—¶å…‰</text>
    <button class="btn-primary" bindtap="createAlbum">åˆ›å»ºç›¸å†Œ</button>
  </view>

  <!-- æ‰¹é‡æ“ä½œæ¨¡å¼ -->
  <view class="batch-mode" wx:if="{{isBatchMode}}">
    <view class="batch-header">
      <text class="batch-title">æ‰¹é‡æ“ä½œæ¨¡å¼</text>
      <button class="btn-secondary" bindtap="exitBatchMode">é€€å‡º</button>
    </view>
    
    <view class="batch-actions">
      <button class="btn-danger" bindtap="batchDelete" disabled="{{selectedAlbums.length === 0}}">
        åˆ é™¤é€‰ä¸­ ({{selectedAlbums.length}})
      </button>
      <button class="btn-secondary" bindtap="selectAll">
        {{isAllSelected ? 'å–æ¶ˆå…¨é€‰' : 'å…¨é€‰'}}
      </button>
    </view>
  </view>

  <!-- æµ®åŠ¨æ“ä½œæŒ‰é’® -->
  <view class="fab" bindtap="toggleBatchMode">
    <text class="fab-icon">{{isBatchMode ? 'âœ•' : 'âš™ï¸'}}</text>
  </view>
</view>
