<!--pages/statistics/statistics.wxml-->
<view class="container">
  <!-- é¡µé¢æ ‡é¢˜ -->
  <view class="page-header">
    <text class="page-title">æˆ‘çš„æ—…æ¸¸ç»Ÿè®¡</text>
    <text class="page-subtitle">è®°å½•æ¯ä¸€æ¬¡æ—…è¡Œçš„ç¾å¥½</text>
    <view class="activity-level">
      <text class="level-text">{{activityLevel}}</text>
      <text class="score-text">æ´»è·ƒåº¦ {{activityScore}}åˆ†</text>
    </view>
  </view>

  <!-- ç»Ÿè®¡æ¦‚è§ˆ -->
  <view class="overview-section">
    <view class="overview-title">
      <image class="title-icon" src="/images/graph.png" mode="aspectFit"></image>
      æ•°æ®æ¦‚è§ˆ
    </view>
    <view class="overview-cards">
      <view class="overview-card primary">
        <image class="card-icon" src="/images/pin.png" mode="aspectFit"></image>
        <view class="card-content">
          <text class="card-value">{{totalCheckins}}</text>
          <text class="card-label">æ‰“å¡æ¬¡æ•°</text>
        </view>
      </view>
      
      <view class="overview-card success">
        <image class="card-icon" src="/images/cinema.png" mode="aspectFit"></image>
        <view class="card-content">
          <text class="card-value">{{totalPhotos}}</text>
          <text class="card-label">ç…§ç‰‡æ•°é‡</text>
        </view>
      </view>
      
      <view class="overview-card warning">
        <image class="card-icon" src="/images/route.png" mode="aspectFit"></image>
        <view class="card-content">
          <text class="card-value">{{totalDistance}}</text>
          <text class="card-label">è¡Œç¨‹å…¬é‡Œ</text>
        </view>
      </view>
      
      <view class="overview-card info">
        <image class="card-icon" src="/images/light-bulb.png" mode="aspectFit"></image>
        <view class="card-content">
          <text class="card-value">{{totalDays}}</text>
          <text class="card-label">æ´»è·ƒå¤©æ•°</text>
        </view>
      </view>
    </view>
  </view>

  <!-- æ—¶é—´ç­›é€‰ -->
  <view class="filter-section">
    <view class="filter-title">æ—¶é—´èŒƒå›´</view>
    <view class="time-filters">
      <view class="filter-btn {{timeRange === 'week' ? 'active' : ''}}" bindtap="setTimeRange" data-range="week">
        æœ¬å‘¨
      </view>
      <view class="filter-btn {{timeRange === 'month' ? 'active' : ''}}" bindtap="setTimeRange" data-range="month">
        æœ¬æœˆ
      </view>
      <view class="filter-btn {{timeRange === 'year' ? 'active' : ''}}" bindtap="setTimeRange" data-range="year">
        æœ¬å¹´
      </view>
      <view class="filter-btn {{timeRange === 'all' ? 'active' : ''}}" bindtap="setTimeRange" data-range="all">
        å…¨éƒ¨
      </view>
    </view>
  </view>

  <!-- æ‰“å¡ç»Ÿè®¡ -->
  <view class="stats-section">
    <view class="section-title">
      <image class="section-icon" src="/images/pin.png" mode="aspectFit"></image>
      æ‰“å¡ç»Ÿè®¡
    </view>
    
    <view class="stats-content">
      <!-- è¿ç»­æ‰“å¡ -->
      <view class="streak-section">
        <view class="streak-item">
          <view class="streak-icon">ğŸ”¥</view>
          <view class="streak-info">
            <text class="streak-label">å½“å‰è¿ç»­</text>
            <text class="streak-value">{{checkinStreak}}å¤©</text>
          </view>
        </view>
        <view class="streak-item">
          <view class="streak-icon">ğŸ†</view>
          <view class="streak-info">
            <text class="streak-label">æœ€é•¿è¿ç»­</text>
            <text class="streak-value">{{longestStreak}}å¤©</text>
          </view>
        </view>
      </view>
      
      <!-- æ‰“å¡è¶‹åŠ¿å›¾ -->
      <view class="chart-container">
        <view class="chart-title">æ‰“å¡è¶‹åŠ¿</view>
        <view class="trend-chart">
          <view class="chart-bar" wx:for="{{checkinTrend}}" wx:key="date" style="height: {{item.height}}%">
            <view class="bar-tooltip">{{item.count}}æ¬¡</view>
          </view>
        </view>
        <view class="chart-labels">
          <text wx:for="{{checkinTrend}}" wx:key="date">{{item.label}}</text>
        </view>
      </view>
      
      <!-- æ‰“å¡è¯¦æƒ… -->
      <view class="stats-grid">
        <view class="stat-item">
          <text class="stat-label">æœ€å¸¸æ‰“å¡æ—¶é—´</text>
          <text class="stat-value">{{mostCheckinTime}}</text>
        </view>
        <view class="stat-item">
          <text class="stat-label">å¹³å‡æ‰“å¡é—´éš”</text>
          <text class="stat-value">{{avgCheckinInterval}}</text>
        </view>
        <view class="stat-item">
          <text class="stat-label">æœ€é•¿æ‰“å¡é—´éš”</text>
          <text class="stat-value">{{maxCheckinInterval}}</text>
        </view>
      </view>
    </view>
  </view>

  <!-- ç…§ç‰‡ç»Ÿè®¡ -->
  <view class="stats-section">
    <view class="section-title">
      <image class="section-icon" src="/images/cinema.png" mode="aspectFit"></image>
      ç…§ç‰‡ç»Ÿè®¡
    </view>
    
    <view class="stats-content">
      <view class="photo-stats">
        <view class="stat-row">
          <text class="stat-label">ç…§ç‰‡æ€»æ•°</text>
          <text class="stat-value">{{photoStats.total}}</text>
        </view>
        <view class="stat-row">
          <text class="stat-label">æœ¬æœˆæ–°å¢</text>
          <text class="stat-value">{{photoStats.thisMonth}}</text>
        </view>
        <view class="stat-row">
          <text class="stat-label">æœ¬å‘¨æ–°å¢</text>
          <text class="stat-value">{{photoStats.thisWeek}}</text>
        </view>
        <view class="stat-row">
          <text class="stat-label">å¹³å‡æ¯å¤©</text>
          <text class="stat-value">{{photoStats.avgPerDay}}</text>
        </view>
      </view>
      
    </view>
  </view>

  <!-- åœ°ç‚¹ç»Ÿè®¡ -->
  <view class="stats-section">
    <view class="section-title">
      <image class="section-icon" src="/images/map-3.png" mode="aspectFit"></image>
      åœ°ç‚¹ç»Ÿè®¡
    </view>
    
    <view class="stats-content">
      <view class="location-stats">
        <view class="top-locations">
          <view class="location-item" wx:for="{{topLocations}}" wx:key="name">
            <view class="location-rank">{{index + 1}}</view>
            <view class="location-info">
              <text class="location-name">{{item.name}}</text>
              <text class="location-count">{{item.count}}æ¬¡æ‰“å¡</text>
            </view>
            <view class="location-percentage">{{item.percentage}}%</view>
          </view>
        </view>
      </view>
    </view>
  </view>

  <!-- ç¾¤ç»„ç»Ÿè®¡ -->
  <view class="stats-section">
    <view class="section-title">
      <image class="section-icon" src="/images/group-1.png" mode="aspectFit"></image>
      ç¾¤ç»„ç»Ÿè®¡
    </view>
    
    <view class="stats-content">
      <view class="group-stats">
        <view class="group-stat-item">
          <image class="stat-icon" src="/images/graph.png" mode="aspectFit"></image>
          <view class="stat-info">
            <text class="stat-label">æ€»ç¾¤ç»„æ•°</text>
            <text class="stat-value">{{groupStats.total}}</text>
          </view>
        </view>
        <view class="group-stat-item">
          <view class="stat-icon">â•</view>
          <view class="stat-info">
            <text class="stat-label">åˆ›å»ºç¾¤ç»„</text>
            <text class="stat-value">{{groupStats.created}}</text>
          </view>
        </view>
        <view class="group-stat-item">
          <image class="stat-icon" src="/images/networking.png" mode="aspectFit"></image>
          <view class="stat-info">
            <text class="stat-label">åŠ å…¥ç¾¤ç»„</text>
            <text class="stat-value">{{groupStats.joined}}</text>
          </view>
        </view>
        <view class="group-stat-item">
          <view class="stat-icon">ğŸ”¥</view>
          <view class="stat-info">
            <text class="stat-label">æ´»è·ƒç¾¤ç»„</text>
            <text class="stat-value">{{groupStats.active}}</text>
          </view>
        </view>
      </view>
    </view>
  </view>

  <!-- æ´»è·ƒåº¦ç»Ÿè®¡ -->
  <view class="stats-section">
    <view class="section-title">
      <image class="section-icon" src="/images/newspaper.png" mode="aspectFit"></image>
      æ´»è·ƒåº¦åˆ†æ
    </view>
    
    <view class="stats-content">
      <!-- å‘¨æ´»è·ƒåº¦ -->
      <view class="activity-chart">
        <view class="chart-title">æœ¬å‘¨æ´»è·ƒåº¦</view>
        <view class="weekly-chart">
          <view class="day-item" wx:for="{{weeklyActivity}}" wx:key="date">
            <view class="day-bar" style="height: {{item.total * 10}}rpx;"></view>
            <text class="day-label">{{item.date}}</text>
            <text class="day-count">{{item.total}}</text>
          </view>
        </view>
      </view>
      
      <!-- æ´»è·ƒåº¦ç­‰çº§ -->
      <view class="activity-level-card">
        <view class="level-icon">â­</view>
        <view class="level-info">
          <text class="level-title">{{activityLevel}}</text>
          <text class="level-desc">æ´»è·ƒåº¦ {{activityScore}}åˆ†</text>
        </view>
        <view class="level-progress">
          <view class="progress-bar">
            <view class="progress-fill" style="width: {{activityScore / 10}}%;"></view>
          </view>
          <text class="progress-text">{{activityScore}}/1000</text>
        </view>
      </view>
    </view>
  </view>

  <!-- æˆå°±ç³»ç»Ÿ -->
  <view class="stats-section">
    <view class="section-title">ğŸ† æˆå°±å¾½ç« </view>
    
    <view class="stats-content">
      <view class="achievements-grid">
        <view class="achievement-item" wx:for="{{achievements}}" wx:key="name">
          <view class="achievement-icon">
            <text>{{item.icon}}</text>
          </view>
          <view class="achievement-info">
            <text class="achievement-name">{{item.name}}</text>
            <text class="achievement-desc">{{item.desc}}</text>
          </view>
          <view class="achievement-status unlocked">å·²è·å¾—</view>
        </view>
        
        <view wx:if="{{achievements.length === 0}}" class="no-achievements">
          <text class="no-achievements-text">æš‚æ— æˆå°±ï¼Œç»§ç»­åŠªåŠ›å§ï¼</text>
        </view>
      </view>
    </view>
  </view>

  <!-- åˆ†äº«æŒ‰é’® -->
  <view class="share-section">
    <button class="share-btn" open-type="share">
      <text class="share-text">åˆ†äº«ç»Ÿè®¡æŠ¥å‘Š</text>
    </button>
  </view>

</view>