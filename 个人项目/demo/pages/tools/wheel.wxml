<view class="container">
  <!-- å¯¼èˆªæ  -->
  <view class="nav-bar">
    <view class="nav-title">éšæœºè½¬ç›˜</view>
  </view>

  <!-- ç¾¤ç»„ä¿¡æ¯ -->
  <view class="group-info" wx:if="{{groupInfo}}">
    <text class="group-name">{{groupInfo.name}}</text>
    <text class="group-desc">{{groupInfo.description || 'æš‚æ— æè¿°'}}</text>
  </view>

  <!-- æœªå®Œæˆæˆå‘˜å¤´åƒ -->
  <view class="members-section">
    <view class="section-header">
      <text class="section-title">æœªå®Œæˆè¾“å…¥</text>
      <text class="member-count">{{completedCount}}/{{members.length}}</text>
    </view>
    
    <view class="members-row">
      <view class="member-avatar" wx:for="{{filteredIncompleteMembers}}" wx:key="id">
        <image class="avatar-img" src="{{item.avatarUrl || '/images/default-avatar.png'}}" mode="aspectFill"></image>
        <view class="avatar-status incomplete"></view>
      </view>
      
      <!-- çœç•¥å·æŒ‰é’® -->
      <view class="more-btn" wx:if="{{showMoreBtn}}" bindtap="showAllIncompleteMembers">
        <text class="more-text">...</text>
      </view>
    </view>
  </view>

  <!-- è½¬ç›˜åŒºåŸŸ -->
  <view class="wheel-section">
    <view class="wheel-container">
      <!-- è½¬ç›˜ç»„ä»¶ -->
      <view class="wheel" wx:if="{{wheelItems.length > 0}}" style="transform: rotate({{rotation}}deg); transition: transform {{spinDuration}}ms ease-out;">
        <view class="wheel-part" wx:for="{{wheelItems}}" wx:key="id" 
              style="background-color: {{item.color}}; transform: rotate({{item.angle}}deg) skewY({{90 - 360/wheelItems.length}}deg);">
          <view class="wheel-text" style="transform: skewY({{360/wheelItems.length - 90}}deg) rotate({{90 - item.startAngle}}deg);">
            {{item.content}}
          </view>
        </view>
        <!-- è½¬ç›˜ä¸­å¿ƒ -->
        <view class="wheel-center"></view>
      </view>
      
      <!-- è½¬ç›˜æŒ‡é’ˆ -->
      <view class="wheel-pointer" wx:if="{{wheelItems.length > 0}}"></view>
      
      <!-- ç©ºçŠ¶æ€æ˜¾ç¤º -->
      <view class="empty-wheel" wx:if="{{wheelItems.length === 0}}">
        <text class="empty-text">æš‚æ— å†…å®¹ï¼Œè¯·å…ˆè¾“å…¥</text>
      </view>
    </view>
  </view>

  <!-- æ“ä½œæŒ‰é’® -->
  <view class="action-buttons">
    <button class="btn input-btn" bindtap="navigateToInput">
      <text class="btn-text">è¾“å…¥å†…å®¹</text>
    </button>
    
    <button class="btn start-btn" bindtap="startSpin" disabled="{{isSpinning || wheelItems.length === 0}}">
      <text class="btn-text">{{isSpinning ? 'è½¬åŠ¨ä¸­...' : 'å¼€å§‹'}}</text>
    </button>
  </view>

  <!-- æœªå®Œæˆæˆå‘˜å¼¹çª— -->
  <view class="modal-overlay" wx:if="{{showMembersModal}}" bindtap="hideMembersModal">
    <view class="modal-content" catchtap="stopPropagation">
      <view class="modal-header">
        <text class="modal-title">æœªå®Œæˆæˆå‘˜</text>
        <text class="modal-close" bindtap="hideMembersModal">Ã—</text>
      </view>
      
      <view class="modal-body">
        <view class="members-grid">
          <view class="member-item" wx:for="{{incompleteMembers}}" wx:key="id">
            <image class="member-img" src="{{item.avatarUrl || '/images/default-avatar.png'}}" mode="aspectFill"></image>
            <text class="member-name">{{item.nickName}}</text>
          </view>
        </view>
      </view>
      
      <view class="modal-footer">
        <button class="modal-btn" bindtap="hideMembersModal">å…³é—­</button>
      </view>
    </view>
  </view>

  <!-- ç»“æœå¼¹çª— -->
  <view class="modal-overlay" wx:if="{{showResultModal}}" bindtap="hideResultModal">
    <view class="modal-content result-modal" catchtap="stopPropagation">
      <view class="result-icon">ğŸ‰</view>
      <text class="result-title">æŠ½å¥–ç»“æœ</text>
      <text class="result-content">{{selectedItem.content}}</text>
      <text class="result-user">æ¥è‡ª {{selectedItem.userName}}</text>
      
      <button class="modal-btn" bindtap="hideResultModal">ç¡®å®š</button>
    </view>
  </view>
</view>